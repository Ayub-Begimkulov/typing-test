{"type":"javascript","text":"import { useCallback, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useLatest } from './use-latest';\nimport './styles.css';\n\nfunction getSearchParam(search, param) {\n  const searchParams = new URLSearchParams(search);\n  return searchParams.get(param);\n}\n\nfunction setSearchParam(search, param, value) {\n  const searchParams = new URLSearchParams(search);\n  searchParams.set(param, value);\n  return searchParams.toString();\n}\n\nconst defaultDeserialize = v => v;\nconst defaultSerialize = String;\n\nexport function useSearchParamsState({\n  name,\n  serialize = defaultSerialize,\n  desirialize = defaultDeserialize,\n}) {\n  const history = useHistory();\n  const [value, setValue] = useState(() => {\n    const initialValue = desirialize(\n      getSearchParam(history.location.search, name)\n    );\n\n    return initialValue;\n  });\n  const latestValue = useLatest(value);\n\n  const updateValue = useCallback(\n    newValue => {\n      const search = history.location.search;\n      const actualNewValue =\n        typeof newValue === 'function'\n          ? newValue(latestValue.current)\n          : newValue;\n\n      setValue(actualNewValue);\n\n      const newSearch = setSearchParam(search, name, serialize(actualNewValue));\n\n      history.replace({\n        search: newSearch,\n      });\n    },\n    [latestValue, history, name, serialize]\n  );\n\n  return [value, updateValue];\n}","words":[{"text":"import","type":"Keyword","range":[0,6]},{"text":"useCallback","type":"Identifier","range":[9,20]},{"text":"useState","type":"Identifier","range":[22,30]},{"text":"from","type":"Identifier","range":[33,37]},{"text":"'react'","type":"String","range":[38,45]},{"text":"import","type":"Keyword","range":[47,53]},{"text":"useHistory","type":"Identifier","range":[56,66]},{"text":"from","type":"Identifier","range":[69,73]},{"text":"'react-router-dom'","type":"String","range":[74,92]},{"text":"import","type":"Keyword","range":[94,100]},{"text":"useLatest","type":"Identifier","range":[103,112]},{"text":"from","type":"Identifier","range":[115,119]},{"text":"'./use-latest'","type":"String","range":[120,134]},{"text":"import","type":"Keyword","range":[136,142]},{"text":"'./styles.css'","type":"String","range":[143,157]},{"text":"function","type":"Keyword","range":[160,168]},{"text":"getSearchParam","type":"Identifier","range":[169,183]},{"text":"search","type":"Identifier","range":[184,190]},{"text":"param","type":"Identifier","range":[192,197]},{"text":"const","type":"Keyword","range":[203,208]},{"text":"searchParams","type":"Identifier","range":[209,221]},{"text":"new","type":"Keyword","range":[224,227]},{"text":"URLSearchParams","type":"Identifier","range":[228,243]},{"text":"search","type":"Identifier","range":[244,250]},{"text":"return","type":"Keyword","range":[255,261]},{"text":"searchParams","type":"Identifier","range":[262,274]},{"text":"get","type":"Identifier","range":[275,278]},{"text":"param","type":"Identifier","range":[279,284]},{"text":"function","type":"Keyword","range":[290,298]},{"text":"setSearchParam","type":"Identifier","range":[299,313]},{"text":"search","type":"Identifier","range":[314,320]},{"text":"param","type":"Identifier","range":[322,327]},{"text":"value","type":"Identifier","range":[329,334]},{"text":"const","type":"Keyword","range":[340,345]},{"text":"searchParams","type":"Identifier","range":[346,358]},{"text":"new","type":"Keyword","range":[361,364]},{"text":"URLSearchParams","type":"Identifier","range":[365,380]},{"text":"search","type":"Identifier","range":[381,387]},{"text":"searchParams","type":"Identifier","range":[392,404]},{"text":"set","type":"Identifier","range":[405,408]},{"text":"param","type":"Identifier","range":[409,414]},{"text":"value","type":"Identifier","range":[416,421]},{"text":"return","type":"Keyword","range":[426,432]},{"text":"searchParams","type":"Identifier","range":[433,445]},{"text":"toString","type":"Identifier","range":[446,454]},{"text":"const","type":"Keyword","range":[461,466]},{"text":"defaultDeserialize","type":"Identifier","range":[467,485]},{"text":"v","type":"Identifier","range":[488,489]},{"text":"v","type":"Identifier","range":[493,494]},{"text":"const","type":"Keyword","range":[496,501]},{"text":"defaultSerialize","type":"Identifier","range":[502,518]},{"text":"String","type":"Identifier","range":[521,527]},{"text":"export","type":"Keyword","range":[530,536]},{"text":"function","type":"Keyword","range":[537,545]},{"text":"useSearchParamsState","type":"Identifier","range":[546,566]},{"text":"name","type":"Identifier","range":[571,575]},{"text":"serialize","type":"Identifier","range":[579,588]},{"text":"defaultSerialize","type":"Identifier","range":[591,607]},{"text":"desirialize","type":"Identifier","range":[611,622]},{"text":"defaultDeserialize","type":"Identifier","range":[625,643]},{"text":"const","type":"Keyword","range":[652,657]},{"text":"history","type":"Identifier","range":[658,665]},{"text":"useHistory","type":"Identifier","range":[668,678]},{"text":"const","type":"Keyword","range":[684,689]},{"text":"value","type":"Identifier","range":[691,696]},{"text":"setValue","type":"Identifier","range":[698,706]},{"text":"useState","type":"Identifier","range":[710,718]},{"text":"const","type":"Keyword","range":[731,736]},{"text":"initialValue","type":"Identifier","range":[737,749]},{"text":"desirialize","type":"Identifier","range":[752,763]},{"text":"getSearchParam","type":"Identifier","range":[771,785]},{"text":"history","type":"Identifier","range":[786,793]},{"text":"location","type":"Identifier","range":[794,802]},{"text":"search","type":"Identifier","range":[803,809]},{"text":"name","type":"Identifier","range":[811,815]},{"text":"return","type":"Keyword","range":[829,835]},{"text":"initialValue","type":"Identifier","range":[836,848]},{"text":"const","type":"Keyword","range":[858,863]},{"text":"latestValue","type":"Identifier","range":[864,875]},{"text":"useLatest","type":"Identifier","range":[878,887]},{"text":"value","type":"Identifier","range":[888,893]},{"text":"const","type":"Keyword","range":[899,904]},{"text":"updateValue","type":"Identifier","range":[905,916]},{"text":"useCallback","type":"Identifier","range":[919,930]},{"text":"newValue","type":"Identifier","range":[936,944]},{"text":"const","type":"Keyword","range":[956,961]},{"text":"search","type":"Identifier","range":[962,968]},{"text":"history","type":"Identifier","range":[971,978]},{"text":"location","type":"Identifier","range":[979,987]},{"text":"search","type":"Identifier","range":[988,994]},{"text":"const","type":"Keyword","range":[1002,1007]},{"text":"actualNewValue","type":"Identifier","range":[1008,1022]},{"text":"typeof","type":"Keyword","range":[1033,1039]},{"text":"newValue","type":"Identifier","range":[1040,1048]},{"text":"'function'","type":"String","range":[1053,1063]},{"text":"newValue","type":"Identifier","range":[1076,1084]},{"text":"latestValue","type":"Identifier","range":[1085,1096]},{"text":"current","type":"Identifier","range":[1097,1104]},{"text":"newValue","type":"Identifier","range":[1118,1126]},{"text":"setValue","type":"Identifier","range":[1135,1143]},{"text":"actualNewValue","type":"Identifier","range":[1144,1158]},{"text":"const","type":"Keyword","range":[1168,1173]},{"text":"newSearch","type":"Identifier","range":[1174,1183]},{"text":"setSearchParam","type":"Identifier","range":[1186,1200]},{"text":"search","type":"Identifier","range":[1201,1207]},{"text":"name","type":"Identifier","range":[1209,1213]},{"text":"serialize","type":"Identifier","range":[1215,1224]},{"text":"actualNewValue","type":"Identifier","range":[1225,1239]},{"text":"history","type":"Identifier","range":[1250,1257]},{"text":"replace","type":"Identifier","range":[1258,1265]},{"text":"search","type":"Identifier","range":[1276,1282]},{"text":"newSearch","type":"Identifier","range":[1284,1293]},{"text":"latestValue","type":"Identifier","range":[1317,1328]},{"text":"history","type":"Identifier","range":[1330,1337]},{"text":"name","type":"Identifier","range":[1339,1343]},{"text":"serialize","type":"Identifier","range":[1345,1354]},{"text":"return","type":"Keyword","range":[1364,1370]},{"text":"value","type":"Identifier","range":[1372,1377]},{"text":"updateValue","type":"Identifier","range":[1379,1390]}]}