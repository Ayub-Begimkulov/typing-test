{"type":"typescript","text":"import { useMemo, useReducer } from 'react';\n\ntype AnyAction = {\n  type: string;\n  payload?: any;\n};\n\ntype AnyActionCreator = (payload?: any) => void;\n\ntype Tail<T extends readonly unknown[]> = T extends readonly [any, ...infer U]\n  ? U\n  : never;\n\ntype Method<State> = (state: State, payload?: any) => State;\n\n/* type UseMethodsActionCreator<\n  ActionMethod extends Method<any>,\n  PayloadType extends Parameters<ActionMethod>[1] = Parameters<ActionMethod>[1]\n> = undefined extends PayloadType\n  ? (payload?: PayloadType) => void\n  : void extends PayloadType\n  ? (payload?: PayloadType) => void\n  : (payload: PayloadType) => void; */\n\ntype UseMethodsActionCreator<ActionMethod extends Method<any>> = (\n  ...args: Tail<Parameters<ActionMethod>>\n) => void;\n\ntype UseMethodsActionCreators<Methods extends Record<string, Method<any>>> = {\n  [Key in keyof Methods]: UseMethodsActionCreator<Methods[Key]>;\n};\n\nexport function useMethods<\n  State,\n  Methods extends Record<string, Method<State>>\n>(\n  methods: Methods | (() => Methods),\n  initialState: State\n): [State, UseMethodsActionCreators<Methods>] {\n  const reducer = (state: State, action: AnyAction) => {\n    const { type, payload } = action;\n    const actualMethods = typeof methods === 'function' ? methods() : methods;\n\n    const method = actualMethods[type];\n\n    if (!method) {\n      return state;\n    }\n\n    return method(state, payload);\n  };\n\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  const methodsActions = useMemo(() => {\n    const actualMethods = typeof methods === 'function' ? methods() : methods;\n\n    return Object.keys(actualMethods).reduce(\n      (result: Record<string, AnyActionCreator>, type) => {\n        result[type] = (payload?: any) => {\n          dispatch({ type, payload });\n        };\n        return result;\n      },\n      {}\n    ) as UseMethodsActionCreators<Methods>;\n  }, []);\n\n  return [state, methodsActions];\n}\n\nconst [state, actions] = useMethods(\n  () => ({\n    increment(state) {\n      return { ...state, count: state.count + 1 };\n    },\n    decrement(state) {\n      return { ...state, count: state.count - 1 };\n    },\n    incrementBy(state, count: number) {\n      return { ...state, count: state.count + count };\n    },\n    decrementBy(state, count: number) {\n      return { ...state, count: state.count - count };\n    },\n  }),\n  { count: 0 }\n);","words":[{"text":"import","type":"Keyword","range":[0,6]},{"text":"useMemo","type":"Identifier","range":[9,16]},{"text":"useReducer","type":"Identifier","range":[18,28]},{"text":"from","type":"Identifier","range":[31,35]},{"text":"'react'","type":"String","range":[36,43]},{"text":"type","type":"Identifier","range":[46,50]},{"text":"AnyAction","type":"Identifier","range":[51,60]},{"text":"type","type":"Identifier","range":[67,71]},{"text":"string","type":"Identifier","range":[73,79]},{"text":"payload","type":"Identifier","range":[83,90]},{"text":"any","type":"Identifier","range":[93,96]},{"text":"type","type":"Identifier","range":[102,106]},{"text":"AnyActionCreator","type":"Identifier","range":[107,123]},{"text":"payload","type":"Identifier","range":[127,134]},{"text":"any","type":"Identifier","range":[137,140]},{"text":"void","type":"Keyword","range":[145,149]},{"text":"type","type":"Identifier","range":[152,156]},{"text":"Tail","type":"Identifier","range":[157,161]},{"text":"T","type":"Identifier","range":[162,163]},{"text":"extends","type":"Keyword","range":[164,171]},{"text":"readonly","type":"Identifier","range":[172,180]},{"text":"unknown","type":"Identifier","range":[181,188]},{"text":"T","type":"Identifier","range":[194,195]},{"text":"extends","type":"Keyword","range":[196,203]},{"text":"readonly","type":"Identifier","range":[204,212]},{"text":"any","type":"Identifier","range":[214,217]},{"text":"infer","type":"Identifier","range":[222,227]},{"text":"U","type":"Identifier","range":[228,229]},{"text":"U","type":"Identifier","range":[235,236]},{"text":"never","type":"Identifier","range":[241,246]},{"text":"type","type":"Identifier","range":[249,253]},{"text":"Method","type":"Identifier","range":[254,260]},{"text":"State","type":"Identifier","range":[261,266]},{"text":"state","type":"Identifier","range":[271,276]},{"text":"State","type":"Identifier","range":[278,283]},{"text":"payload","type":"Identifier","range":[285,292]},{"text":"any","type":"Identifier","range":[295,298]},{"text":"State","type":"Identifier","range":[303,308]},{"text":" type UseMethodsActionCreator<\n  ActionMethod extends Method<any>,\n  PayloadType extends Parameters<ActionMethod>[1] = Parameters<ActionMethod>[1]\n> = undefined extends PayloadType\n  ? (payload?: PayloadType) => void\n  : void extends PayloadType\n  ? (payload?: PayloadType) => void\n  : (payload: PayloadType) => void; ","type":"Block","range":[311,633]},{"text":"type","type":"Identifier","range":[635,639]},{"text":"UseMethodsActionCreator","type":"Identifier","range":[640,663]},{"text":"ActionMethod","type":"Identifier","range":[664,676]},{"text":"extends","type":"Keyword","range":[677,684]},{"text":"Method","type":"Identifier","range":[685,691]},{"text":"any","type":"Identifier","range":[692,695]},{"text":"args","type":"Identifier","range":[707,711]},{"text":"Tail","type":"Identifier","range":[713,717]},{"text":"Parameters","type":"Identifier","range":[718,728]},{"text":"ActionMethod","type":"Identifier","range":[729,741]},{"text":"void","type":"Keyword","range":[749,753]},{"text":"type","type":"Identifier","range":[756,760]},{"text":"UseMethodsActionCreators","type":"Identifier","range":[761,785]},{"text":"Methods","type":"Identifier","range":[786,793]},{"text":"extends","type":"Keyword","range":[794,801]},{"text":"Record","type":"Identifier","range":[802,808]},{"text":"string","type":"Identifier","range":[809,815]},{"text":"Method","type":"Identifier","range":[817,823]},{"text":"any","type":"Identifier","range":[824,827]},{"text":"Key","type":"Identifier","range":[838,841]},{"text":"in","type":"Keyword","range":[842,844]},{"text":"keyof","type":"Identifier","range":[845,850]},{"text":"Methods","type":"Identifier","range":[851,858]},{"text":"UseMethodsActionCreator","type":"Identifier","range":[861,884]},{"text":"Methods","type":"Identifier","range":[885,892]},{"text":"Key","type":"Identifier","range":[893,896]},{"text":"export","type":"Keyword","range":[904,910]},{"text":"function","type":"Keyword","range":[911,919]},{"text":"useMethods","type":"Identifier","range":[920,930]},{"text":"State","type":"Identifier","range":[934,939]},{"text":"Methods","type":"Identifier","range":[943,950]},{"text":"extends","type":"Keyword","range":[951,958]},{"text":"Record","type":"Identifier","range":[959,965]},{"text":"string","type":"Identifier","range":[966,972]},{"text":"Method","type":"Identifier","range":[974,980]},{"text":"State","type":"Identifier","range":[981,986]},{"text":"methods","type":"Identifier","range":[994,1001]},{"text":"Methods","type":"Identifier","range":[1003,1010]},{"text":"Methods","type":"Identifier","range":[1020,1027]},{"text":"initialState","type":"Identifier","range":[1032,1044]},{"text":"State","type":"Identifier","range":[1046,1051]},{"text":"State","type":"Identifier","range":[1056,1061]},{"text":"UseMethodsActionCreators","type":"Identifier","range":[1063,1087]},{"text":"Methods","type":"Identifier","range":[1088,1095]},{"text":"const","type":"Keyword","range":[1102,1107]},{"text":"reducer","type":"Identifier","range":[1108,1115]},{"text":"state","type":"Identifier","range":[1119,1124]},{"text":"State","type":"Identifier","range":[1126,1131]},{"text":"action","type":"Identifier","range":[1133,1139]},{"text":"AnyAction","type":"Identifier","range":[1141,1150]},{"text":"const","type":"Keyword","range":[1161,1166]},{"text":"type","type":"Identifier","range":[1169,1173]},{"text":"payload","type":"Identifier","range":[1175,1182]},{"text":"action","type":"Identifier","range":[1187,1193]},{"text":"const","type":"Keyword","range":[1199,1204]},{"text":"actualMethods","type":"Identifier","range":[1205,1218]},{"text":"typeof","type":"Keyword","range":[1221,1227]},{"text":"methods","type":"Identifier","range":[1228,1235]},{"text":"'function'","type":"String","range":[1240,1250]},{"text":"methods","type":"Identifier","range":[1253,1260]},{"text":"methods","type":"Identifier","range":[1265,1272]},{"text":"const","type":"Keyword","range":[1279,1284]},{"text":"method","type":"Identifier","range":[1285,1291]},{"text":"actualMethods","type":"Identifier","range":[1294,1307]},{"text":"type","type":"Identifier","range":[1308,1312]},{"text":"if","type":"Keyword","range":[1320,1322]},{"text":"method","type":"Identifier","range":[1325,1331]},{"text":"return","type":"Keyword","range":[1341,1347]},{"text":"state","type":"Identifier","range":[1348,1353]},{"text":"return","type":"Keyword","range":[1366,1372]},{"text":"method","type":"Identifier","range":[1373,1379]},{"text":"state","type":"Identifier","range":[1380,1385]},{"text":"payload","type":"Identifier","range":[1387,1394]},{"text":"const","type":"Keyword","range":[1405,1410]},{"text":"state","type":"Identifier","range":[1412,1417]},{"text":"dispatch","type":"Identifier","range":[1419,1427]},{"text":"useReducer","type":"Identifier","range":[1431,1441]},{"text":"reducer","type":"Identifier","range":[1442,1449]},{"text":"initialState","type":"Identifier","range":[1451,1463]},{"text":"const","type":"Keyword","range":[1469,1474]},{"text":"methodsActions","type":"Identifier","range":[1475,1489]},{"text":"useMemo","type":"Identifier","range":[1492,1499]},{"text":"const","type":"Keyword","range":[1512,1517]},{"text":"actualMethods","type":"Identifier","range":[1518,1531]},{"text":"typeof","type":"Keyword","range":[1534,1540]},{"text":"methods","type":"Identifier","range":[1541,1548]},{"text":"'function'","type":"String","range":[1553,1563]},{"text":"methods","type":"Identifier","range":[1566,1573]},{"text":"methods","type":"Identifier","range":[1578,1585]},{"text":"return","type":"Keyword","range":[1592,1598]},{"text":"Object","type":"Identifier","range":[1599,1605]},{"text":"keys","type":"Identifier","range":[1606,1610]},{"text":"actualMethods","type":"Identifier","range":[1611,1624]},{"text":"reduce","type":"Identifier","range":[1626,1632]},{"text":"result","type":"Identifier","range":[1641,1647]},{"text":"Record","type":"Identifier","range":[1649,1655]},{"text":"string","type":"Identifier","range":[1656,1662]},{"text":"AnyActionCreator","type":"Identifier","range":[1664,1680]},{"text":"type","type":"Identifier","range":[1683,1687]},{"text":"result","type":"Identifier","range":[1702,1708]},{"text":"type","type":"Identifier","range":[1709,1713]},{"text":"payload","type":"Identifier","range":[1718,1725]},{"text":"any","type":"Identifier","range":[1728,1731]},{"text":"dispatch","type":"Identifier","range":[1748,1756]},{"text":"type","type":"Identifier","range":[1759,1763]},{"text":"payload","type":"Identifier","range":[1765,1772]},{"text":"return","type":"Keyword","range":[1796,1802]},{"text":"result","type":"Identifier","range":[1803,1809]},{"text":"as","type":"Identifier","range":[1835,1837]},{"text":"UseMethodsActionCreators","type":"Identifier","range":[1838,1862]},{"text":"Methods","type":"Identifier","range":[1863,1870]},{"text":"return","type":"Keyword","range":[1886,1892]},{"text":"state","type":"Identifier","range":[1894,1899]},{"text":"methodsActions","type":"Identifier","range":[1901,1915]},{"text":"const","type":"Keyword","range":[1921,1926]},{"text":"state","type":"Identifier","range":[1928,1933]},{"text":"actions","type":"Identifier","range":[1935,1942]},{"text":"useMethods","type":"Identifier","range":[1946,1956]},{"text":"increment","type":"Identifier","range":[1973,1982]},{"text":"state","type":"Identifier","range":[1983,1988]},{"text":"return","type":"Keyword","range":[1998,2004]},{"text":"state","type":"Identifier","range":[2010,2015]},{"text":"count","type":"Identifier","range":[2017,2022]},{"text":"state","type":"Identifier","range":[2024,2029]},{"text":"count","type":"Identifier","range":[2030,2035]},{"text":"1","type":"Numeric","range":[2038,2039]},{"text":"decrement","type":"Identifier","range":[2054,2063]},{"text":"state","type":"Identifier","range":[2064,2069]},{"text":"return","type":"Keyword","range":[2079,2085]},{"text":"state","type":"Identifier","range":[2091,2096]},{"text":"count","type":"Identifier","range":[2098,2103]},{"text":"state","type":"Identifier","range":[2105,2110]},{"text":"count","type":"Identifier","range":[2111,2116]},{"text":"1","type":"Numeric","range":[2119,2120]},{"text":"incrementBy","type":"Identifier","range":[2135,2146]},{"text":"state","type":"Identifier","range":[2147,2152]},{"text":"count","type":"Identifier","range":[2154,2159]},{"text":"number","type":"Identifier","range":[2161,2167]},{"text":"return","type":"Keyword","range":[2177,2183]},{"text":"state","type":"Identifier","range":[2189,2194]},{"text":"count","type":"Identifier","range":[2196,2201]},{"text":"state","type":"Identifier","range":[2203,2208]},{"text":"count","type":"Identifier","range":[2209,2214]},{"text":"count","type":"Identifier","range":[2217,2222]},{"text":"decrementBy","type":"Identifier","range":[2237,2248]},{"text":"state","type":"Identifier","range":[2249,2254]},{"text":"count","type":"Identifier","range":[2256,2261]},{"text":"number","type":"Identifier","range":[2263,2269]},{"text":"return","type":"Keyword","range":[2279,2285]},{"text":"state","type":"Identifier","range":[2291,2296]},{"text":"count","type":"Identifier","range":[2298,2303]},{"text":"state","type":"Identifier","range":[2305,2310]},{"text":"count","type":"Identifier","range":[2311,2316]},{"text":"count","type":"Identifier","range":[2319,2324]},{"text":"count","type":"Identifier","range":[2345,2350]},{"text":"0","type":"Numeric","range":[2352,2353]}]}