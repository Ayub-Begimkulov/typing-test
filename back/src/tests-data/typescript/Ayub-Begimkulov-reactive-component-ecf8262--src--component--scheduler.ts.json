{"type":"typescript","text":"import { makeSet } from \"../utils\";\n\nconst jobs: (() => void)[] = [];\nconst promise = Promise.resolve();\nlet pending = false;\n\nexport const nextTick = (fn?: () => void) => (fn ? promise.then(fn) : promise);\n\nexport const queueJob = (job: () => void) => {\n  jobs.push(job);\n  queueFlush();\n};\n\nconst queueFlush = () => {\n  if (!pending) {\n    pending = true;\n    nextTick(flushJobs);\n  }\n};\n\nconst flushJobs = () => {\n  const jobsToRun = makeSet(jobs);\n  jobs.length = 0;\n  jobsToRun.forEach(job => job());\n  if (jobs.length > 0) {\n    flushJobs();\n  }\n  pending = false;\n};","words":[{"text":"import","type":"Keyword","range":[0,6]},{"text":"makeSet","type":"Identifier","range":[9,16]},{"text":"from","type":"Identifier","range":[19,23]},{"text":"\"../utils\"","type":"String","range":[24,34]},{"text":"const","type":"Keyword","range":[37,42]},{"text":"jobs","type":"Identifier","range":[43,47]},{"text":"void","type":"Keyword","range":[56,60]},{"text":"const","type":"Keyword","range":[70,75]},{"text":"promise","type":"Identifier","range":[76,83]},{"text":"Promise","type":"Identifier","range":[86,93]},{"text":"resolve","type":"Identifier","range":[94,101]},{"text":"let","type":"Keyword","range":[105,108]},{"text":"pending","type":"Identifier","range":[109,116]},{"text":"false","type":"Boolean","range":[119,124]},{"text":"export","type":"Keyword","range":[127,133]},{"text":"const","type":"Keyword","range":[134,139]},{"text":"nextTick","type":"Identifier","range":[140,148]},{"text":"fn","type":"Identifier","range":[152,154]},{"text":"void","type":"Keyword","range":[163,167]},{"text":"fn","type":"Identifier","range":[173,175]},{"text":"promise","type":"Identifier","range":[178,185]},{"text":"then","type":"Identifier","range":[186,190]},{"text":"fn","type":"Identifier","range":[191,193]},{"text":"promise","type":"Identifier","range":[197,204]},{"text":"export","type":"Keyword","range":[208,214]},{"text":"const","type":"Keyword","range":[215,220]},{"text":"queueJob","type":"Identifier","range":[221,229]},{"text":"job","type":"Identifier","range":[233,236]},{"text":"void","type":"Keyword","range":[244,248]},{"text":"jobs","type":"Identifier","range":[257,261]},{"text":"push","type":"Identifier","range":[262,266]},{"text":"job","type":"Identifier","range":[267,270]},{"text":"queueFlush","type":"Identifier","range":[275,285]},{"text":"const","type":"Keyword","range":[293,298]},{"text":"queueFlush","type":"Identifier","range":[299,309]},{"text":"if","type":"Keyword","range":[322,324]},{"text":"pending","type":"Identifier","range":[327,334]},{"text":"pending","type":"Identifier","range":[342,349]},{"text":"true","type":"Boolean","range":[352,356]},{"text":"nextTick","type":"Identifier","range":[362,370]},{"text":"flushJobs","type":"Identifier","range":[371,380]},{"text":"const","type":"Keyword","range":[391,396]},{"text":"flushJobs","type":"Identifier","range":[397,406]},{"text":"const","type":"Keyword","range":[419,424]},{"text":"jobsToRun","type":"Identifier","range":[425,434]},{"text":"makeSet","type":"Identifier","range":[437,444]},{"text":"jobs","type":"Identifier","range":[445,449]},{"text":"jobs","type":"Identifier","range":[454,458]},{"text":"length","type":"Identifier","range":[459,465]},{"text":"0","type":"Numeric","range":[468,469]},{"text":"jobsToRun","type":"Identifier","range":[473,482]},{"text":"forEach","type":"Identifier","range":[483,490]},{"text":"job","type":"Identifier","range":[491,494]},{"text":"job","type":"Identifier","range":[498,501]},{"text":"if","type":"Keyword","range":[508,510]},{"text":"jobs","type":"Identifier","range":[512,516]},{"text":"length","type":"Identifier","range":[517,523]},{"text":"0","type":"Numeric","range":[526,527]},{"text":"flushJobs","type":"Identifier","range":[535,544]},{"text":"pending","type":"Identifier","range":[554,561]},{"text":"false","type":"Boolean","range":[564,569]}]}